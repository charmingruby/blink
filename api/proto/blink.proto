syntax = "proto3";

package blink;

option go_package = "blink/api/proto/pb";

enum BlinkStatus {
    BLINK_STATUS_UNSPECIFIED = 0;
    BLINK_STATUS_ON_COOLDOWN = 1;
    BLINK_STATUS_PROCESSING = 2;
    BLINK_STATUS_SUCCESS = 3;
    BLINK_STATUS_FAILURE = 4;
};

enum BlinkEvaluationStatus {
    BLINK_EVALUATION_STATUS_UNSPECIFIED = 0;
    BLINK_EVALUATION_STATUS_BOOTSTRAP = 1;
    BLINK_EVALUATION_STATUS_CREATE = 2;
}

message EvaluateBlinkIntentRequest {
    string nickname = 1;
};

message EvaluateBlinkIntentReply {
    BlinkStatus status = 1;
    double remaining_cooldown = 2;
};

service EvaluationService {
    rpc EvaluateBlinkIntent(EvaluateBlinkIntentRequest) returns (EvaluateBlinkIntentReply);
};

message BlinkEvaluatedEvent {
    string idempotency_key = 1;
    string nickname = 2;
    optional string tracer_id = 3;
    BlinkEvaluationStatus status = 4;
    int32 current_blinks_count = 5;
};
